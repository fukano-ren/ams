<% if session[:system] == true %>
  <p id="notice"><%= notice %></p>
    <div align=right>
      <%= link_to "ログアウト" , controller: :login, action: :index %>
    </div>

  <h1>ユーザー情報一覧</h1>

  <%= page_entries_info @users %>

  <%= form_tag({:action=>"search"},{:method=>"GET"}) do %>
    <table border="1">
      <tr>
        <th>コード</th>
        <th><%= text_field_tag "search[code]" %></th>
      </tr>
      <tr>
        <th>氏名</th>
        <th><%= text_field_tag "search[name]" %></th>
      </tr> 
      <tr>
        <th>部署</th>
        <th><%= collection_select(:department, :name, Department.all, :id, :name, :prompt => "すべて") %></th>
      </tr>
    </table>
    <span><%= submit_tag "検索" %></span>
  <% end %>
  <div style="margin-left:535px"><%= paginate @users %></div>
  <table border="1">
    <thead>
      <tr>
        <th align=center width="70" height="30">コード</th>
        <th align=center width="120" height="30">氏名</th>
        <th align=center width="120" height="30">部署</th>
        <th align=center width="100" height="30">システム管理</th>
        <th align=center width="70" height="30">資産管理</th>
        <th align=center width="120" height="30" colspan="3">アクション</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td align=center height="30"><%= user.code %></td>
          <td align=center height="30"><%= user.name %></td>
          <td align=center height="30"><%= user.department.try(:name) %></td>
          <td align=center height="30">
            <% if user.system == true %>
              ○
            <% else %>
              
            <% end %>
          </td>
          <td align=center height="30">
            <% if user.admin == true %>
              ○
            <% else %>
              
            <% end %>
          </td>
          <td align=center height="30">
          <%= link_to '詳細', user %>
          <%= link_to '変更', edit_user_path(user) %>
          <%= link_to '削除', user, method: :delete, data: { confirm: 'Are you sure?' } %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <span align="left"><%= link_to '新規ユーザー登録', new_user_path %></span>
  <span align="center"><%= link_to '一括変更', users_zen_edit_path %></span>
  <span align="right"><%= link_to 'メニューに戻る', menu_index_path %></span>

<% else %>

  <p id="notice"><%= notice %></p>
    <div align=right>
      <%= link_to "ログアウト" , controller: :login, action: :index %>
    </div>

  <h1>ユーザー情報一覧</h1>

  <%= page_entries_info @users %>

  <%= form_tag({:action=>"search"},{:method=>"GET"}) do %>
    <%= text_field_tag "search[title]" %>
    <%= submit_tag "検索" %>
  <% end %>
  <div style="margin-left:535px"><%= paginate @users %></div>
  <table border="1">
    <thead>
      <tr>
        <th align=center width="70" height="30">コード</th>
        <th align=center width="70" height="30">氏名</th>
        <th align=center width="70" height="30">部署</th>
        <th align=center width="70" height="30" colspan="3">アクション</th>
      </tr>
    </thead>

    <tbody>
      <% @users.each do |user| %>
        <% if user.name == session[:name] %>
          <tr>
            <td align=center height="30"><%= user.code %></td>
            <td align=center height="30"><%= user.name %></td>
            <td align=center height="30"><%= user.department.try(:name) %></td>
            <td align=center height="30">
              <%= link_to '詳細', user %>
              <%= link_to '変更', edit_user_path(user) %>
              <%= link_to '削除', user, method: :delete, data: { confirm: 'Are you sure?' } %>
            </td>
          </tr>
        <% else %>
          <tr>
            <td align=center height="30"><%= user.code %></td>
            <td align=center height="30"><%= user.name %></td>
            <td align=center height="30"><%= user.department.try(:name) %></td>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>

  <%= link_to '新規ユーザー登録', new_user_path %>
  <%= link_to 'メニューに戻る', menu_index_path %>

<% end %>